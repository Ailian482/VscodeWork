- 火车票自主预订异常转人工
  - 授信订单
    - 1.订单付款状态
      - 部分出票失败
        - 不存在保险
          - 付款状态为「已记账」
        - 存在保险
          - 保险已处理
            - 投保成功，付款状态为「已记账」
            - 投保失败，付款状态为「已记账」
          - 保险未处理
            - 付款状态为「预记账」
      - 全部出票失败
        - 付款状态为「未付款」，保险状态为「已取消」（×）
      - 全部出票成功
        - 不存在保险
          - 付款状态为「已记账」
        - 存在保险
          - 保险未处理
            - 付款状态为「预记账」
          - 保险已处理
            - 投保成功，付款状态为「已记账」
            - 投保取消，付款状态为「已记账」
    - 2.乘客付款状态、保险状态
      - 出票成功
        - 存在保险
          - 保险已处理
            - 保险取消，付款状态为「已记账」，保险状态为「已取消」
            - 投保成功，付款状态为「已记账」，保险状态为「已购买」
          - 保险未处理
            - 付款状态为「预记账」，保险状态为「待购买」
        - 不存在保险
          - 投保成功，付款状态为「已记账」
      - 出票失败
        - 存在保险
          - 付款状态为「未付款」，保险状态为「已取消」
        - 不存在保险
          - 付款状态为「未付款」
  
  - 个付订单
    - 1.订单付款状态
      - 部分出票失败
        - 无保险
          - 未退款：付款状态为「待退款」
          - 已退款：付款状态为「部分退款」
        - 有保险
          - 出票失败部分未退款
            - 保险已处理
              - 投保成功，付款状态为「待退款」
              - 投保失败
                - 保险未退款，付款状态为「待退款」
                - 保险已退款，付款状态为「待退款」
              - 保险未处理
                - 付款状态为「待退款」
          - 出票失败部分已退款
            - 保险已处理
              - 投保成功，付款状态为「部分退款」
              - 投保失败
                - 保险未退款，付款状态为「待退款」
                - 保险已退款，付款状态为「部分退款」
            - 保险未处理
              - 付款状态为「部分退款」
      - 全部出票失败
        - 付款状态为「待退款」
      - 全部出票成功
        - 不存在差价
          - 付款状态为「已付款」
        - 存在差价
          - 不存在保险
            - 差价未退款，付款状态为「待退款」
            - 差价已退款，付款状态为「部分退款」
          - 存在保险
            - 差价未退款
              - 保险未处理
                - 付款状态为「待退款」
              - 保险已处理
                - 投保成功，付款状态为「待退款」
                - 投保取消，付款状态为「待退款」
            - 差价已退款
              - 保险未处理
                - 付款状态为「部分退款」
              - 保险已处理
                - 投保成功，付款状态为「部分退款」
                - 投保取消
                  - 保险未退款，付款状态为「待退款」
                  - 保险已退款，付款状态为「部分退款」
    - 2.乘客付款状态、保险状态
      - 出票失败
        - 未退款：付款状态为「待退款」，保险状态为「已取消」
        - 已退款：付款状态为「已退款」，保险状态为「已取消」
      - 出票成功
        - 不存在差价
          - 付款状态为「已付款」
        - 存在差价
          - 差价未退款
            - 不存在保险
              - 付款状态为「已付款」
            - 存在保险
              - 保险未处理
                - 付款状态为「已付款」，保险状态为「待购买」
              - 保险已处理
                - 保险取消，付款状态为「已付款」，保险状态为「已取消」
                - 投保成功，付款状态为「已付款」，保险状态为「已购买」
          - 差价已退款，付款状态为「已付款」
            - 不存在保险
              - 付款状态为「已付款」
            - 存在保险
              - 保险未处理
                - 付款状态为「已付款」，保险状态为「待购买」
              - 保险已处理
                - 保险取消，付款状态为「已付款」，保险状态为「已取消」
                - 投保成功，付款状态为「已付款」，保险状态为「已购买」
    - 3.退款操作历史
      - 保险取消
        - 占座成功转人工出票：发起申请退款操作历史，退款成功操作历史
        - 占座失败转人工出票：发起申请退款操作历史，退款成功操作历史
      - 出票失败
        - 占座成功转人工出票：发起申请退款操作历史，退款成功操作历史
        - 占座失败转人工出票：发起申请退款操作历史，退款成功操作历史
      - 差价退款
        - 占座失败转人工出票：发起申请退款操作历史，退款成功操作历史


### 问题
- 1. 授信，只处理了部分保险任务，就将已处理保险任务的子订单记录到消费明细（220013153，暂不处理）
- 2. 后台订单详情：
  - 金额明细的 席别展示的不是真实的席别信息
- 3. 个付，仅存在票差，已退款完成，订单付款状态错误，应该为「部分退款」
- 4. 个付，投保取消，
  - 待退款，不能申请退改，应该能申请      ---（已解决，乘客付款状态更改为「已付款」）
  - 部分退款，不能申请退改，应该能申请      ---（已解决，乘客付款状态更改为「已付款」）
- 5. 个付，票差未退款，保险已退款，订单付款状态被更新为「部分退款」，应该为「待退款」
- 6. 个付，同一个订单，给多个乘客分别单独购保，最后一个投保任务把前面的投保任务也合并了     ---（已解决）
- 7. 个付，原单存在保险任务，也能申请改签，应该不能申请     ---（已解决）
- 8. 个付，改签单的票面价，展示为 0
- 9. 退保页面展示异常       ---（已解决）
- 10. 授信，存在票差，保险任务还未处理，预记账金额与订单金额对不上（未重新预记账）
- 11. 授信退票单，保险任务已处理完，付款状态为「已退款」应该为「已记账」
- 12. 正常预订，个付，存在投保失败，未退款，订单付款状态为「已付款」应该为「待退款」；下单的操作历史，没有填充客服名字
- 13. 正常预订，个付，存在保险（投保成功），申请退票，没有生成退票单      ---（已解决）
- 14. 存在差价是，前端传的 票面价值的类型为 字符串，应该为 数值
- 15. 个付订单，原单退保成功，改签单投保失败，改签单没有退保险款      ---（已解决）

### 问题 2
- 1. 个付订单，投保失败，订单付款状态为「已付款」，应该为「待退款」（以前就是这样，暂不修改）
- 2. 个付订单，退票时，退保任务还未处理，就生成了退票单的退款任务，导致退保失败后，还需要退保险金额（旧 bug）
- 3. 个付订单，退票时，退保失败，退票单的保险金额被重置为 0（以前就是这样，暂不修改）
- 4. 个付订单，存在其他乘客有退改操作，未投保乘客再申请单独购保，没有自动投保成功，也没有生成投保任务（旧 bug）
- 5. 个付，同一个订单，给多个乘客分别单独购保，第一个投保任务处理完之后，任务列表还有任务。     ---（220013428-已解决）
- 6. 个付，出票成功，多人投保任务，处理任意一个投保任务后，其他人的投保任务处理不了（220013488、220013493）
- 7. 授信，自动出票成功，先记录一条车票款消费明细，投保成功后，又记录一条保险款消费明细（220013499）
